// Generated by CoffeeScript 1.6.3
(function() {
  var Nex,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  Nex = this.Nex || require('nex');

  Nex.Page = (function(_super) {
    __extends(Page, _super);

    Page.include(Nex.Panel);

    Page.prototype.className = 'page';

    Page.prototype.logPrefix = "(App) Page: ";

    function Page() {
      this.onKeyup = __bind(this.onKeyup, this);
      Page.__super__.constructor.apply(this, arguments);
      this.tmpl404 = '<h1>Page not Found</h1>';
      this.controllers = [];
      this.bind('ready', this.render);
      this.active(this.getData);
    }

    Page.prototype.render = function(result) {
      var _ref;
      if (!((_ref = result.items) != null ? _ref.length : void 0)) {
        return this.html(this.tmpl404({
          language: Nex.language
        }));
      }
    };

    Page.prototype.add = function(controller) {
      this.controllers.push(controller);
      return this.append(controller);
    };

    Page.prototype.activate = function() {
      $('body').on('keyup.page', this.onKeyup);
      return Page.__super__.activate.apply(this, arguments);
    };

    Page.prototype.deactivate = function() {
      $('body').off('.page');
      this.clear();
      return Page.__super__.deactivate.apply(this, arguments);
    };

    Page.prototype.clear = function() {
      var cont, _i, _len, _ref;
      _ref = this.controllers;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        cont = _ref[_i];
        cont.release();
      }
      return this.controllers = [];
    };

    Page.prototype.onKeyup = function(e) {
      this.log('onKeyup', e.keyCode);
      e.preventDefault();
      if (!this.isActive()) {
        return;
      }
      switch (e.keyCode) {
        case 27:
          if (this.onEsc) {
            return this.onEsc();
          }
      }
    };

    return Page;

  })(Spine.Controller);

  module.exports = Nex.Page;

}).call(this);

/*
//@ sourceMappingURL=page.map
*/
